{
  "files": [
    {
      "id": "91298fd1-e3fd-471c-8998-b531a67fcd80",
      "name": "appsscript",
      "type": "json",
      "source": "{\n  \"timeZone\": \"America/Bogota\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\",\n  \"runtimeVersion\": \"V8\"\n}"
    },
    {
      "id": "e151644c-03c1-4b55-bf07-00b7b93a6e11",
      "name": "Global",
      "type": "server_js",
      "source": "const mainFolderId = '11IZK6hiBakYCNgQMfx4m-1T0euP-BQiG';\nconst templateSheetId = '18i85sTEdoILukc2W3TdEVNpV-QLvPiZECw0LUcJEj7A';\nconst templateMirrorSheetId = '1lj5YfrJMxO3Z3mnLv-l7_BFHS3EQ32fhLbIi3RdKRmw';\nconst mirrorSheetsFolderId = '1fkPwq7plgXtVbV33X5rOikv4P_4T4OsI';\n\nconst historyFolderId = '1ts43OWnaYHLvJebkDaFJVv4UN6i1MtK6';\n\nconst WebAppUrl = 'https://script.google.com/macros/s/AKfycbz7aiNm-YO1hzmICctSfcdxErcaA_1OVoB6ULndACmgarB851ZN8XqnfGqGYfD86FGQ/exec'; \n\nvar ss = SpreadsheetApp.getActiveSpreadsheet();\n\nfunction onOpen(e){  \n    var ui = SpreadsheetApp.getUi();\n    ui.createMenu('WEB APP')\n      .addItem('Ver web app', 'showWebAppUrl')\n      .addToUi();\n\n    ui.createMenu('HOJA')\n      .addItem('Actualizar indices', 'writeColumnIndexes')\n        .addSubMenu(ui.createMenu('Historial')\n          .addItem('Copiar versión actual al historial', 'moveToHistory')\n          .addItem('Ver historial de programa', 'seeHistoryLink'))\n        .addSubMenu(ui.createMenu('Hojas espejo')\n          // .addItem('Crear nueva hoja espejo editable', 'createMirrorSheet')\n          // .addItem('Conectar hoja espejo', 'pasteMirrorSheetValues')\n          .addItem('Crear hoja espejo de lectura', 'showMirrorSheetForm'))\n      .addToUi();\n}\n"
    },
    {
      "id": "29090cf3-cc53-4d31-82e9-1eb33f6be166",
      "name": "Code",
      "type": "server_js",
      "source": "function createMirrorSheet(){\n  var destFolder = DriveApp.getFolderById(mainFolderId); \n  var title = \"Nueva hoja espejo\";\n  var url = DriveApp.getFileById(templateSheetId).makeCopy(title, destFolder).getUrl(); \n  showCreatedMirrorSheet(title, url);\n}\n\nfunction pasteMirrorSheetValues(){\n  // var ss = SpreadsheetApp.getActiveSpreadsheet();\n  var row = ss.getActiveCell().getRow();\n  var col = ss.getActiveCell().getColumn();\n  if(row > 5) return;\n\n  let mirrorSheetUrl = Browser.inputBox('Copia el enlace de la hoja espejo que quieres mostrar acá')\n  if(mirrorSheetUrl == 'cancel') return;\n  \n  var [titleFormula,rangeFormula] = getFormulasForMirrorSheet(mirrorSheetUrl);\n\n  ss.getActiveSheet().getRange(1,col).setValue(titleFormula);\n  ss.getActiveSheet().getRange(5,col).setValue(rangeFormula);\n}\n\nfunction writeColumnIndexes() {\n  // var ss = SpreadsheetApp.getActiveSpreadsheet();\n  var active = ss.getActiveSheet();\n\n  var indicesObj = {};\n  \n  var columns = active.getMaxColumns();\n  for(let col=1; col<=columns; col++){\n    var columnName = active.getRange(1,col).getValue();\n    var indexName = createColumnIndexName(columnName);\n\n    if(!indicesObj[indexName]){\n      indicesObj[indexName] = 1;\n    }else if(indicesObj[indexName] == 1){\n      let count = 1;\n      while(indicesObj[indexName] == 1){\n        if(indexName == '') break;\n        indexName += 'X';\n        count++;\n      }\n      indicesObj[indexName] = 1;\n    }\n    active.getRange(3,col).setValue(indexName);\n  }\n\n  ss.getActiveSheet().getRange('4:4').insertCheckboxes();\n}\n\nfunction getSheetColumns(){\n  // var ss = SpreadsheetApp.getActiveSpreadsheet();\n  var active = ss.getActiveSheet();\n\n  var values = active.getRange(1,1,3,active.getMaxColumns()).getValues();\n  var columns = {}\n  columns.titles = values[0];\n  columns.indices = values[2];\n  \n  return columns;\n}\n\n\n\n"
    },
    {
      "id": "44171c1b-bdb9-4957-9db4-bb677e981a39",
      "name": "History",
      "type": "server_js",
      "source": "function getHistoryLink(){\n  var [url] = getDocumentProperties(['historyLink'])\n  if(!url) {\n    var url = createBlankSpreadsheet();\n    SpreadsheetApp.openByUrl(url).setName('Historial ' + ss.getName());\n    setDocumentProperties(['historyLink'],[url]);\n    return url;\n  }\n  else return url;\n}\n\nfunction moveToHistory() {  \n  var name = Browser.inputBox('Escribe un nombre para la nueva en el historial:');\n  if(name == 'cancel') return;\n  name += ` (${new Date().toISOString().split('T')[0]})`;\n  showLoadingDialog();\n\n  var historyUrl = getHistoryLink();\n  var ss1 = SpreadsheetApp.openByUrl(historyUrl);\n\n  ss.getActiveSheet().copyTo(ss1).setName(name).deleteRows(2,3);\n  ss1.getSheetByName(name).activate();\n  ss1.moveActiveSheet(1);\n\n  var ogSheet = ss1.getSheetByName('View only');\n  if(ogSheet) ss1.deleteSheet(ogSheet);\n  seeHistoryLink();\n}\n\nfunction seeHistoryLink(){\n  var url = getHistoryLink();\n  var name = SpreadsheetApp.openByUrl(url).getName();\n  showUrl(url, `Archivo historial: \"${name}\"`);\n}\n\n// function createHistorySheet(){\n//   var destFolder = DriveApp.getFolderById(historyFolderId); \n//   var title = \"Historial programa\";\n//   var programSheetId = SpreadsheetApp.getActive().getId();\n//   var url = DriveApp.getFileById(programSheetId).makeCopy(title, destFolder).getUrl();\n//   // SpreadsheetApp.openByUrl(url).getSheets();\n//   setDocumentProperties(['historyLink'],[url]);\n//   return url;\n//   // showCreatedProgramSheet(title, url);\n// }"
    },
    {
      "id": "53f09c16-42b9-4dd8-b2ea-c218dd115248",
      "name": "Dialogs",
      "type": "server_js",
      "source": "// function showAppPreview() {\n//   var ss1 = SpreadsheetApp.getActiveSpreadsheet();\n//   var html = HtmlService.createTemplateFromFile('Responsive');\n//   // var mockStudentId = ss1.getSheets()[0].getDataRange().getValues()[ID_ROW+1][0];\n//   // var text = getStudentCode(mockStudentId);\n//   var page = html.evaluate();\n//   page.addMetaTag('viewport', 'width=device-width, initial-scale=1');\n//   page.append(`<div class=\"container\">`);\n//   page.append(text);\n//   page.append(`</div>`);\n//   // return page.getContent();\n//   output.setTitle('');\n//   page.addMetaTag('viewport', 'width=device-width, initial-scale=1');\n//   page.setWidth(2000).setHeight(700);\n//   SpreadsheetApp.getUi().showModalDialog(page, 'Web app - Autogestión | CCA');\n// }\n\n// function showWebApp() { // private version\n//   var html = HtmlService.createTemplateFromFile('Preview');\n//   var page = html.evaluate();\n//   page.setWidth(2000).setHeight(1000);\n//   SpreadsheetApp.getUi().showModalDialog(page, 'Vista previa web app (versión privada)');\n// }\n\nfunction showUrl(url, title) {\n  var html = HtmlService.createTemplateFromFile('ShareUrl');\n  var page = html.evaluate();\n  // page.append(`<div style=\"text-align:center;margin:50px auto 0;max-width:600px\"></div>`);\n  page.append(`<div class=\"field d-flex align-items-center justify-content-between\">\n                  <span class=\"fas fa-link text-center\"></span> <input type=\"url\" class=\"form-control\" value=\"${url}\">\n                  <a class=\"btn btn-secondary\" href=\"${url}\" target=\"_blank\">\n                    <svg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" class=\"bi bi-link\" viewBox=\"0 0 16 16\">\n                    <path d=\"M6.354 5.5H4a3 3 0 0 0 0 6h3a3 3 0 0 0 2.83-4H9c-.086 0-.17.01-.25.031A2 2 0 0 1 7 10.5H4a2 2 0 1 1 0-4h1.535c.218-.376.495-.714.82-1z\"></path>\n                    <path d=\"M9 5.5a3 3 0 0 0-2.83 4h1.098A2 2 0 0 1 9 6.5h3a2 2 0 1 1 0 4h-1.535a4.02 4.02 0 0 1-.82 1H12a3 3 0 1 0 0-6H9z\"></path>\n</svg>\n                  </a>  \n                  <button class=\"btn btn-primary my-2\">Copiar</button> \n              </div>`);\n  // page.append(`</div>`);\n  page.setWidth(500).setHeight(60);\n  SpreadsheetApp.getUi().showModalDialog(page, title);\n}\n\nfunction showWebAppUrl() { // public version\n  showUrl(WebAppUrl, 'Enlace público web app');\n}\n\nfunction showSheetUrl(title, filename, url){\n  var htmlTemplate = HtmlService.createTemplateFromFile('Blank');\n  var page = htmlTemplate.evaluate();  \n  page.append(`<div style=\"text-align:center;margin:25px auto 0;max-width:600px\"></div>`);\n  page.append(`<a href=\"${url}\" target=\"_blank\" class=\"link-primary\">${filename}.</a>`);\n  page.append(`</div>`);\n  page.setWidth(500).setHeight(80);\n  SpreadsheetApp.getUi().showModalDialog(page, title);\n}\n\nfunction showCreatedMirrorSheet(filename, url){\n  showSheetUrl(\n    'Nueva hoja espejo de lectura creada', \n    filename + ' (ABRE LA HOJA Y OTORGA EL PERMISO PARA CONECTAR LA HOJA)', \n    url);\n  // var htmlTemplate = HtmlService.createTemplateFromFile('Blank');\n  // var page = htmlTemplate.evaluate();  \n  // page.append(`<div style=\"text-align:center;margin:50px auto 0;max-width:600px\"></div>`);\n  // page.append(`Nueva hoja espejo de lectura creada: <a href=\"${url}\" target=\"_blank\" class=\"link-primary\">${filename}.</a>. ABRE LA HOJA Y OTORGA EL PERMISO PARA CONECTAR LA HOJA`);\n  // page.append(`</div>`);\n  // page.setWidth(300).setHeight(200);\n  // SpreadsheetApp.getUi().showModalDialog(page, 'Crear hoja espejo');\n}\n\nfunction showCreatedReadOnlyMirrorSheet(filename, url){\n  showSheetUrl(\n    'Nueva hoja espejo editable creada', \n    filename, \n    url);\n  // var htmlTemplate = HtmlService.createTemplateFromFile('Blank');\n  // var page = htmlTemplate.evaluate();  \n  // page.append(`<div style=\"text-align:center;margin:50px auto 0;max-width:600px\"></div>`);\n  // page.append(`Nueva hoja espejo editable creada: <a href=\"${url}\" target=\"_blank\" class=\"link-primary\">${filename}.</a>`);\n  // page.append(`</div>`);\n  // page.setWidth(300).setHeight(200);\n  // SpreadsheetApp.getUi().showModalDialog(page, 'Crear hoja espejo');\n}\n\n// function showCreateViewOnlyMirrorSheet(){\n//   var htmlTemplate = HtmlService.createTemplateFromFile('ChooseColumns');\n\n//   var columns = getSheetColumns();\n//   var page = htmlTemplate.evaluate();  \n//   page.append(`<div style=\"text-align:center;margin:50px auto 0;max-width:600px\"></div>`);\n//   page.append(`Nueva hoja espejo editable creada: <a href=\"${url}\" target=\"_blank\" class=\"link-primary\">${filename}.</a>`);\n//   page.append(`</div>`);\n//   page.setWidth(300).setHeight(200);\n//   SpreadsheetApp.getUi().showModalDialog(page, 'Crear hoja espejo');\n// }\n\nfunction showLoadingDialog(action){\n  var htmlOutput = HtmlService\n    .createHtmlOutput(``)\n    .setWidth(200)\n    .setHeight(200);\n  SpreadsheetApp.getUi().showModalDialog(htmlOutput, action ? action : 'Cargando...');\n}\n\nfunction closeLoadingDialog(action){\n  var htmlOutput = HtmlService\n    .createHtmlOutput(`<script>google.script.host.close();</script>`)\n    .setWidth(200)\n    .setHeight(200);\n  SpreadsheetApp.getUi().showModalDialog(htmlOutput, action ? action : 'Success');\n}\n\nfunction showResponse(errorMessage){\n  var htmlOutput = HtmlService\n    .createHtmlOutput(`<div style=\"text-align: center; font-family: monospace;\">${errorMessage}</div>`)\n    .setWidth(300)\n    .setHeight(200);\n  SpreadsheetApp.getUi().showModalDialog(htmlOutput, 'Resultado');\n}\n\n"
    },
    {
      "id": "22f0c37b-ed87-43af-8524-685e7f3e8f09",
      "name": "App",
      "type": "server_js",
      "source": "// function doGet(e){\n//   var action = e.parameter.r;\n//   var parameterA = e.parameter.a;\n\n//   resp = this[action](parameterA);\n//   return ContentService.createTextOutput(resp);\n// }\n\nfunction getProperty(name){\n  var [property] = getDocumentProperties([name]);\n  return property;\n}"
    },
    {
      "id": "5707258b-c7e6-4884-b1f7-966e7b8732cb",
      "name": "Utils",
      "type": "server_js",
      "source": "function getFormulasForMirrorSheet(mirrorSpreadsheetUrl){\n  // mirrorSpreadsheetUrl = mirrorSpreadsheetUrl.split('/edit')[0];\n  var ss1 = SpreadsheetApp.openByUrl(mirrorSpreadsheetUrl);\n  var mirrorSheet = ss1.getSheets()[0];\n\n  var mirrorSheetName = mirrorSheet.getSheetName();\n  var lastColumn = mirrorSheet.getMaxColumns();\n  var lastRow = mirrorSheet.getMaxRows();\n  var lastColumnA1Not = mirrorSheet.getRange(lastRow, lastColumn).getA1Notation().match(/([A-Z]+)/)[0];\n\n  var titleFormula = `=IMPORTRANGE(\"${mirrorSpreadsheetUrl}\";\"'${mirrorSheetName}'!1:1\")`;\n  var rangeFormula = `=IMPORTRANGE(\"${mirrorSpreadsheetUrl}\";\"'${mirrorSheetName}'!A5:${lastColumnA1Not+lastRow.toString()}\")`;\n  \n  return [titleFormula,rangeFormula];\n}\n\nfunction createColumnIndexName(name) {\n  name = name.replace(/[^a-zA-Z0-9\\s]/g, '');\n  name = name.toLowerCase();\n  const toCamelCase = (str) => str.replace(/(?:^\\w|[A-Z]|\\b\\w)/g, (ltr, idx) => idx === 0 ? ltr.toLowerCase() : ltr.toUpperCase()).replace(/\\s+/g, '');\n  name = toCamelCase(name);\n\n  return name;\n}\n\nfunction createCopyOfSheet(title){\n  var destFolder = DriveApp.getFolderById(historyFolderId); \n  var programSheetId = SpreadsheetApp.getActive().getId();\n  var url = DriveApp.getFileById(programSheetId).makeCopy(title, destFolder).getUrl();\n  return url;\n}\n\nfunction createBlankSpreadsheet(title){\n  var destFolder = DriveApp.getFolderById(mirrorSheetsFolderId); \n  var url = DriveApp.getFileById(templateMirrorSheetId).makeCopy(title, destFolder).getUrl();\n  return url;\n}\n\nfunction getUserProperties(keys){\n  var userProperties = PropertiesService.getUserProperties();\n  var propertiesValues = [];\n  keys.map(\n    (key) => {\n      propertiesValues.push(JSON.parse(userProperties.getProperty(key)))\n    }\n  )\n  return propertiesValues;\n}\nfunction setUserProperties( keys, values){\n  var userProperties = PropertiesService.getUserProperties();\n  keys.map(\n    (key, index) => {\n      userProperties.setProperty(key, JSON.stringify(values[index]));\n    }\n  );\n}\nfunction deleteUserProperties(){\n  // Delete all user properties in the current script.\n  var userProperties = PropertiesService.getUserProperties();\n  userProperties.deleteAllProperties();\n}\n\nfunction getDocumentProperties(keys){\n  var documentProperties = PropertiesService.getDocumentProperties();\n  var propertiesValues = [];\n  keys.map(\n    (key) => {\n      propertiesValues.push(JSON.parse(documentProperties.getProperty(key)))\n    }\n  )\n  return propertiesValues;\n}\nfunction setDocumentProperties( keys, values){\n  var documentProperties = PropertiesService.getDocumentProperties();\n  keys.map(\n    (key, index) => {\n      documentProperties.setProperty(key, JSON.stringify(values[index]));\n    }\n  );\n}\nfunction deleteDocumentProperties(){\n  // Delete all document properties in the current script.\n  var documentProperties = PropertiesService.getDocumentProperties();\n  documentProperties.deleteAllProperties();\n}"
    },
    {
      "id": "00fb668c-731b-4e4e-9bce-05cb2c685a61",
      "name": "MirrorSheets",
      "type": "server_js",
      "source": "function showMirrorSheetForm(){\n  var formItems = [];\n  var columns = getSheetColumns();\n  var titles = columns.titles;\n  var indices = columns.indices;\n  for(i in indices){\n    if(indices[i] != '') formItems.push({index: indices[i], title: titles[i]});\n  }\n\n  var html = HtmlService.createTemplateFromFile('ChooseColumns');\n\n  formItems.map(\n    item =>  html[item] = item.index\n  )  \n\n  var page = html.evaluate();\n  page.append(`<form id=\"infoForm\" onsubmit=\"return validarForm(this)\">`);\n  // page.append(`<input type=\"hidden\" id=\"type\" name=\"type\">`);\n  formItems.map(\n    (item, index) =>  page.append(getInputForm(item.index+'-'+index, item.title))\n  )\n  page.append(`<br><div class=\"col-md-12\">`);\n  page.append('<button type=\"submit\" class=\"btn btn-primary my-2 \">Crear</button>');\n  page.append(`</div>`);\n  page.append('</form>');\n  \n  page.append(`</div>`);\n\n  page.addMetaTag('viewport', 'width=device-width, initial-scale=1');\n  page.setWidth(400).setHeight(500);\n  setUserProperties(['formItems'],[formItems]);\n  var programName = ss.getActiveSheet().getName();\n  setUserProperties(['programName'],[programName]);\n  SpreadsheetApp.getUi().showModalDialog(page, 'Crear hoja espejo de lectura');\n}\n\nfunction getInputForm(index, tablaTitle){\n  var event = 'changeCheckbox(this)';\n  var type = 'checkbox';\n\n    return `<div class=\"form-check\">\n              <input \n                type=\"${type}\" \n                class=\"form-check-input\" \n                onclick=\"${event}\" \n                id=\"${index}\" \n                name=\"${index}\"\n                value=\"\" >\n              <label class=\"form-check-label\" for=\"${index}\">${tablaTitle}</label>\n            </div>`;\n}\n\nfunction formChooseColumns(formObject){\n  showLoadingDialog();\n  // try{\n    var form = JSON.parse(JSON.stringify(formObject));\n\n    var chosen = {};\n    for(let index in form){\n      let columnIndex = index.split('-')[0];\n      let columnNumber = index.split('-')[1];\n      chosen[columnIndex] = columnNumber;\n    }\n\n    var [programName] = getUserProperties(['programName']);\n    var mirrorSheetUrl = createReadOnlyMirrorSheet(chosen, programName);\n    showCreatedMirrorSheet('Hoja espejo (lectura) ' + programName,mirrorSheetUrl);\n  // } catch(error){ \n  //   // showErrorDialog(error); \n  //   console.error(error);\n  // }\n}\n\nfunction getColumnFormulaForMirrorSheet(mirrorSpreadsheetUrl,mirrorSheetName, columnNumber){\n  var mirrorSheet = ss.getSheetByName(mirrorSheetName);\n  var lastRow = mirrorSheet.getMaxRows();\n  console.log(columnNumber);\n  var titleA1Not = mirrorSheet.getRange(1, +columnNumber+1).getA1Notation();\n  var valuesA1Not = mirrorSheet.getRange(5, +columnNumber+1, lastRow-4, 1).getA1Notation();\n\n  var titleFormula = `=IMPORTRANGE(\"${mirrorSpreadsheetUrl}\";\"'${mirrorSheetName}'!${titleA1Not}\")`;\n  var rangeFormula = `=IMPORTRANGE(\"${mirrorSpreadsheetUrl}\";\"'${mirrorSheetName}'!${valuesA1Not}\")`;\n  \n  return [titleFormula,rangeFormula];\n}\n\nfunction createReadOnlyMirrorSheet(chosen, sheetName){\n  var copySheetUrl = createBlankSpreadsheet('Hoja espejo (lectura) ' + sheetName);\n  var programUrl = ss.getUrl();\n\n  var sheetFormulas = [[],[]];\n  var chosenArr = [];\n  \n  for(let key in chosen)\n    chosenArr.push(+(chosen[key]));\n  chosenArr.sort(function(a, b) {return a - b;});\n\n  for(let colNumber of chosenArr){\n    let [titleFormula, columnFormula] = getColumnFormulaForMirrorSheet(programUrl, sheetName, colNumber);\n    sheetFormulas[0].push(titleFormula);\n    sheetFormulas[1].push(columnFormula);\n  }\n\n  var programSheetRows = ss.getSheetByName(sheetName).getMaxRows();\n\n  var viewOnlySheet = SpreadsheetApp.openByUrl(copySheetUrl).getSheets()[0];\n  \n  let len = sheetFormulas[0].length;\n  viewOnlySheet.insertColumnsAfter(1,len-1);\n  viewOnlySheet.insertRowsAfter(2,programSheetRows-1);\n\n  viewOnlySheet.getRange(1,1,2,len).setFormulas(sheetFormulas);\n  viewOnlySheet.setName(sheetName);\n\n  return copySheetUrl;\n}"
    },
    {
      "id": "39380fe0-e3cc-41e8-835c-c859eb23d473",
      "name": "Preview",
      "type": "html",
      "source": "<!DOCTYPE html>\n  <html>\n<head>\n    <meta charset=\"UTF-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC\" crossorigin=\"anonymous\">\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM\" crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js\" integrity=\"sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p\" crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js\" integrity=\"sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF\" crossorigin=\"anonymous\"></script>    \n</head>\n<body  style=\"margin:20px\">\n<script src=\"//ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js\">\n</script>\n  <script>\n    $(function () {\n      window.location = '';\n    });\n  </script>\n</body>\n</html>"
    },
    {
      "id": "fafe78e1-b82f-48ce-aad9-bfe632f53ba4",
      "name": "Blank",
      "type": "html",
      "source": "<!DOCTYPE html>\n<html>\n  <head>\n    <!-- <base target=\"_top\"> -->\n    <meta charset=\"UTF-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC\" crossorigin=\"anonymous\">\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM\" crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js\" integrity=\"sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p\" crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js\" integrity=\"sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF\" crossorigin=\"anonymous\"></script>    \n    <!-- <link rel=\"shortcut icon\" href=\"//ssl.gstatic.com/docs/script/images/favicon.ico\"><title>Error</title><style type=\"text/css\" nonce=\"RZWCOFrmxlIpvQgeBrFlnw\">body {background-color: #fff; margin: 0; padding: 0;}.errorMessage {font-family: Arial,sans-serif; font-size: 12pt; font-weight: bold; line-height: 150%; padding-top: 25px;}</style> -->\n  </head>\n  <body style=\"text-align: center\" style=\"margin:20px\">\n    <!-- <div><img alt=\"Google Apps Script\" src=\"//ssl.gstatic.com/docs/script/images/logo.png\"></div> -->\n  </body>\n</html>"
    },
    {
      "id": "606e3c79-7bec-4f87-9631-da2589de3fef",
      "name": "ShareUrl",
      "type": "html",
      "source": "<!DOCTYPE html>\n<html>\n  <head>\n    <!-- <base target=\"_top\"> -->\n    <meta charset=\"UTF-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC\" crossorigin=\"anonymous\">\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM\" crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js\" integrity=\"sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p\" crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js\" integrity=\"sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF\" crossorigin=\"anonymous\"></script>    \n    <!-- <link rel=\"shortcut icon\" href=\"//ssl.gstatic.com/docs/script/images/favicon.ico\"><title>Error</title><style type=\"text/css\" nonce=\"RZWCOFrmxlIpvQgeBrFlnw\">body {background-color: #fff; margin: 0; padding: 0;}.errorMessage {font-family: Arial,sans-serif; font-size: 12pt; font-weight: bold; line-height: 150%; padding-top: 25px;}</style> -->\n  </head>\n  <body style=\"text-align: center\" style=\"margin:20px\">\n    <!-- <div><img alt=\"Google Apps Script\" src=\"//ssl.gstatic.com/docs/script/images/logo.png\"></div> -->\n    <script>\n      document.addEventListener('DOMContentLoaded',function(e){\n      let field = document.querySelector('.field');\n      let input = document.querySelector('input');\n      let copyBtn = document.querySelector('.field button');\n\n      copyBtn.onclick = () =>{\n      input.select();\n      if(document.execCommand(\"copy\")){\n      field.classList.add('active');\n      copyBtn.innerText = 'Copiado';\n      setTimeout(()=>{\n      field.classList.remove('active');\n      copyBtn.innerText = 'Copiar';\n      },3500)\n      }\n      }\n      })\n    </script>\n  </body>\n</html>"
    },
    {
      "id": "24ab635a-befc-4773-822a-fc6c4545c4fa",
      "name": "ChooseColumns",
      "type": "html",
      "source": "<!DOCTYPE html>\n<html>\n  <head>\n    <!-- <base target=\"_top\"> -->\n    <meta charset=\"UTF-8\">\n    <meta http-equiv=\"X-UA-Compatible\" content=\"IE=edge\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <link href=\"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css\" rel=\"stylesheet\" integrity=\"sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC\" crossorigin=\"anonymous\">\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js\" integrity=\"sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM\" crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js\" integrity=\"sha384-IQsoLXl5PILFhosVNubq5LC7Qb9DXgDA9i+tQ8Zj3iwWAwPtgFTxbJ8NT4GN1R8p\" crossorigin=\"anonymous\"></script>\n    <script src=\"https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.min.js\" integrity=\"sha384-cVKIPhGWiC2Al4u+LWgxfKTRIcfu0JTxR+EQDz/bgldoEyl4H0zUF0QKbrJ0EcQF\" crossorigin=\"anonymous\"></script>    \n    <!-- <link rel=\"shortcut icon\" href=\"//ssl.gstatic.com/docs/script/images/favicon.ico\"><title>Error</title><style type=\"text/css\" nonce=\"RZWCOFrmxlIpvQgeBrFlnw\">body {background-color: #fff; margin: 0; padding: 0;}.errorMessage {font-family: Arial,sans-serif; font-size: 12pt; font-weight: bold; line-height: 150%; padding-top: 25px;}</style> -->\n  </head>\n  <body style=\"text-align: center\" style=\"margin:20px\">\n    <!-- <div><img alt=\"Google Apps Script\" src=\"//ssl.gstatic.com/docs/script/images/logo.png\"></div> -->\n    <script>\n      function validarForm(form){\n        google.script.run.withFailureHandler(onFailure).formChooseColumns(form);\n        return false;\n      }\n\n      function onFailure(error){\n        console.log('There was a problem')\n      }\n    </script>\n  </body>\n</html>"
    }
  ]
}
